{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Pawan%20Paliwal/Projects/LIVE/Afford%20Github/app/%28admin%29/afford-admin/Pageloading.tsx"],"sourcesContent":["// app/afford-admin/loading.tsx\r\nexport default function Pageloading() {\r\n  return (\r\n     <div className=\"loader-container\">\r\n      <div className=\"spinner\" />\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,+BAA+B;;;;;;;AAChB,SAAS;IACtB,qBACG,8OAAC;QAAI,WAAU;kBACd,cAAA,8OAAC;YAAI,WAAU;;;;;;;;;;;AAGrB"}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///D:/Pawan%20Paliwal/Projects/LIVE/Afford%20Github/app/%28admin%29/afford-admin/login/page.jsx"],"sourcesContent":["'use client';\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from 'next/navigation';\r\nimport toast from 'react-hot-toast';\r\nimport { useLoginMutation, useCheckLoginQuery, authAPISlice } from \"../../../../store/backendSlice/authAPISlice\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport Pageloading from '../Pageloading';\r\n\r\nexport default function Login() {\r\n  const [loading, setLoading] = useState(false);\r\n  const [UserName, setUserName] = useState(\"\");\r\n  const [Passwords, setPasswords] = useState(\"\");\r\n  const router = useRouter();\r\n  const dispatch = useDispatch();\r\n\r\n  // ✅ Check login status on mount\r\n  const { data: checkData, isSuccess, refetch } = useCheckLoginQuery(undefined, {\r\n    refetchOnMountOrArgChange: true,\r\n    pollingInterval: 10000,\r\n  });\r\n  const [login, { isLoading }] = useLoginMutation();\r\n\r\n  useEffect(() => {\r\n    if (isSuccess && checkData?.loggedIn) {\r\n      router.push(\"/afford-admin/dashboard\");\r\n    }\r\n  }, [isSuccess, checkData, router]);\r\n\r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    try {\r\n      const result = await login({ UserName, Passwords }).unwrap();\r\n      if (result.success) {\r\n        //✅ Immediately update RTK Query cache so we don’t bounce back\r\n        dispatch(\r\n          authAPISlice.util.updateQueryData(\r\n            \"checkLogin\",\r\n            undefined,\r\n            (draft) => {\r\n              draft.loggedIn = true;\r\n              draft.user = result.user || null;\r\n              draft.permissions = result.permissions || null;\r\n            }\r\n          )\r\n        );\r\n        toast.success(\"Login successful!\", { duration: 500 });\r\n        router.push(\"/afford-admin/dashboard\");\r\n      } else {\r\n        toast.error(\"Invalid credentials\", { duration: 1500 });\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Login failed:\", error);\r\n      toast.error(\"Something went wrong. Please try again.\", { duration: 1500 });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"login-wrapper\">\r\n        <div className=\"form-wrap\">\r\n          <div className=\"login-form\" data-tab=\"login-form\">\r\n            <form className=\"model-body\" onSubmit={handleLogin}>\r\n              <div className=\"logo\">\r\n                <img src=\"/admin-assets/img/logo.svg\" alt=\"Logo\" />\r\n              </div>\r\n              <div className=\"form\">\r\n                <div className=\"form-group\">\r\n                  <label htmlFor=\"txtusername\">User Name*</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    id=\"txtusername\"\r\n                    className=\"form-control\"\r\n                    placeholder=\"Enter user name\"\r\n                    value={UserName}\r\n                    onChange={(e) => setUserName(e.target.value)}\r\n                  />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                  <label htmlFor=\"txtpassword\">Password*</label>\r\n                  <div className=\"password-wrap\">\r\n                    <input\r\n                      type=\"password\"\r\n                      id=\"txtpassword\"\r\n                      className=\"form-control login-password\"\r\n                      placeholder=\"Enter Password\"\r\n                      value={Passwords}\r\n                      onChange={(e) => setPasswords(e.target.value)}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <button\r\n                  type=\"submit\"\r\n                  className=\"form-group btn w-100\"\r\n                  disabled={isLoading || loading}\r\n                >\r\n                  {isLoading || loading ? \"Signing in...\" : \"Sign in\"}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* ✅ Show loader while login request is in progress */}\r\n      {loading && <Pageloading />}\r\n    </>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AANA;;;;;;;;AAQe,SAAS;IACtB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,WAAW,IAAA,wKAAW;IAE5B,gCAAgC;IAChC,MAAM,EAAE,MAAM,SAAS,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,IAAA,2JAAkB,EAAC,WAAW;QAC5E,2BAA2B;QAC3B,iBAAiB;IACnB;IACA,MAAM,CAAC,OAAO,EAAE,SAAS,EAAE,CAAC,GAAG,IAAA,yJAAgB;IAE/C,IAAA,kNAAS,EAAC;QACR,IAAI,aAAa,WAAW,UAAU;YACpC,OAAO,IAAI,CAAC;QACd;IACF,GAAG;QAAC;QAAW;QAAW;KAAO;IAEjC,MAAM,cAAc,OAAO;QACzB,EAAE,cAAc;QAChB,WAAW;QACX,IAAI;YACF,MAAM,SAAS,MAAM,MAAM;gBAAE;gBAAU;YAAU,GAAG,MAAM;YAC1D,IAAI,OAAO,OAAO,EAAE;gBAClB,8DAA8D;gBAC9D,SACE,qJAAY,CAAC,IAAI,CAAC,eAAe,CAC/B,cACA,WACA,CAAC;oBACC,MAAM,QAAQ,GAAG;oBACjB,MAAM,IAAI,GAAG,OAAO,IAAI,IAAI;oBAC5B,MAAM,WAAW,GAAG,OAAO,WAAW,IAAI;gBAC5C;gBAGJ,kKAAK,CAAC,OAAO,CAAC,qBAAqB;oBAAE,UAAU;gBAAI;gBACnD,OAAO,IAAI,CAAC;YACd,OAAO;gBACL,kKAAK,CAAC,KAAK,CAAC,uBAAuB;oBAAE,UAAU;gBAAK;YACtD;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,iBAAiB;YAC/B,kKAAK,CAAC,KAAK,CAAC,2CAA2C;gBAAE,UAAU;YAAK;QAC1E,SAAU;YACR,WAAW;QACb;IACF;IAEA,qBACE;;0BACE,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAI,WAAU;wBAAa,YAAS;kCACnC,cAAA,8OAAC;4BAAK,WAAU;4BAAa,UAAU;;8CACrC,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC;wCAAI,KAAI;wCAA6B,KAAI;;;;;;;;;;;8CAE5C,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAM,SAAQ;8DAAc;;;;;;8DAC7B,8OAAC;oDACC,MAAK;oDACL,IAAG;oDACH,WAAU;oDACV,aAAY;oDACZ,OAAO;oDACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;sDAG/C,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAM,SAAQ;8DAAc;;;;;;8DAC7B,8OAAC;oDAAI,WAAU;8DACb,cAAA,8OAAC;wDACC,MAAK;wDACL,IAAG;wDACH,WAAU;wDACV,aAAY;wDACZ,OAAO;wDACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;;;;;;sDAIlD,8OAAC;4CACC,MAAK;4CACL,WAAU;4CACV,UAAU,aAAa;sDAEtB,aAAa,UAAU,kBAAkB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YASrD,yBAAW,8OAAC,8JAAW;;;;;;;AAG9B"}}]
}